
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PREDIKSI HARGA GULA PASIR UNTUK MENGURANGI RESIKO KERUGIAN PERUSAHAAN GULA PASIR &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Gula_fix';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="PREDIKSI HARGA MINYAK CURAH UNTUK MENGURANGI RESIKO KERUGIAN PERUSAHAAN MINYAK CURAH" href="minyak_curah.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="minyak_curah.html">PREDIKSI HARGA MINYAK CURAH UNTUK MENGURANGI RESIKO KERUGIAN PERUSAHAAN MINYAK CURAH</a></li>


<li class="toctree-l1 current active"><a class="current reference internal" href="#">PREDIKSI HARGA GULA PASIR UNTUK MENGURANGI RESIKO KERUGIAN PERUSAHAAN GULA PASIR</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FGula_fix.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Gula_fix.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>PREDIKSI HARGA GULA PASIR UNTUK MENGURANGI RESIKO KERUGIAN PERUSAHAAN GULA PASIR</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">PREDIKSI HARGA GULA PASIR UNTUK MENGURANGI RESIKO KERUGIAN PERUSAHAAN GULA PASIR</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pendahuluan">PENDAHULUAN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#latar-belakang">1. LATAR BELAKANG</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan-proyek">2. TUJUAN PROYEK</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rumusan-masalah">3. RUMUSAN MASALAH</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-yang-digunakan">4. DATA YANG DIGUNAKAN</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pembahasan">PEMBAHASAN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">1. DATA UNDERSTANDING</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-data">Visualisasi Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eksplorasi-data">EKSPLORASI DATA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#struktur-dataset">STRUKTUR DATASET</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#identifikasi-kualitas-data">IDENTIFIKASI KUALITAS DATA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pendeteksian-missing-value">PENDETEKSIAN MISSING VALUE</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing">2. Pre Processing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sliding-windows">Sliding Windows</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#splitting-data-dan-normalisasi">Splitting Data dan Normalisasi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling">3. Modelling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lstm">LSTM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-model">training model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi">4. Evaluasi</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test">test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deployment">Deployment</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="prediksi-harga-gula-pasir-untuk-mengurangi-resiko-kerugian-perusahaan-gula-pasir">
<h1>PREDIKSI HARGA GULA PASIR UNTUK MENGURANGI RESIKO KERUGIAN PERUSAHAAN GULA PASIR<a class="headerlink" href="#prediksi-harga-gula-pasir-untuk-mengurangi-resiko-kerugian-perusahaan-gula-pasir" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="pendahuluan">
<h1>PENDAHULUAN<a class="headerlink" href="#pendahuluan" title="Link to this heading">#</a></h1>
<section id="latar-belakang">
<h2>1. LATAR BELAKANG<a class="headerlink" href="#latar-belakang" title="Link to this heading">#</a></h2>
<p>PT KTM merupakan Produsen Gula Pasir lokal yang bergerak pada bidang Produksi gula mulai dari Gula Lokal sampai Gula Premium.Sebagai Produsen Gula ,PT KTM memiliki visi dan misi untuk menjadi Produsen Gula pasir dalam negeri yang murah dan Terpercaya.</p>
<p>PT KTM bertempat di Jawa yang merupakan salah satu kota besar yang memiliki banyak penduduk dan juga merupakan wilayah yang berhubungan dengan banyak daerah lainnya, karena itu pasti banyak konsumen yang menjadi target penjualan dari Perusahaan. PT KTM Sebagai Produsen Gula PAsir dalm negeri mengutamakan harga yang murah dan dapat memiliki kualitas yang sesuai dengan harga.</p>
<p>Dalam rangka memenuhi visi dan misi tersebut, salah satu tantangan utama yang dihadapi adalah fluktuasi harga yang seringkali sulit diprediksi. Keterbatasan dalam memperoleh informasi harga akan berdampak pada pengambilan Keputusan dalam penjualan yang pada akhirnya dapat berdampak pada pendapatan Perusahaan.</p>
<p>Dalam Konteks Produksi Gula Pasir,prediksi harga pokok memegang peran penting dalam pendapatan Perusahaan.Dengan adanya prediksi harga gula pasir yang akurat ,perusahaan dapat memperkirakan berapa harga gula pasir dalam beberapa hari atau minggu ke depan,sehingga Perusahaan akan lebih baik dalam mengambil Keputusan,sehingga akan dapat meningkatkan pendapatan Perusahaan karena dapatmenjual ketika harga naik dan menyimpan ketika harga akan turun.</p>
<p>Oleh karena itu, proyek ini bertujuan untuk mengembangkan model prediksi Gula PAsir yang dapat membantu Produsen Gula Pasir dalam  mengambil Keputusan dalam penyimpanan stok dan penjualan sehingga dapat meningkatkan pendapatan Perusahaan dan mengurangi risiko kerugian</p>
</section>
<section id="tujuan-proyek">
<h2>2. TUJUAN PROYEK<a class="headerlink" href="#tujuan-proyek" title="Link to this heading">#</a></h2>
<p>Tujuan dari proyek ini adalah sebagai berikut:</p>
<ol class="arabic simple">
<li><p>Mengembangkan model prediksi penjualan yang akurat
Membangun model yang dapat memprediski harga Gula ,agar Perusahaan tahu kapan harus menjual,sehingga dapat mewujudkan visi misi menjadi Produsen Gula termurah dan terpercaya.</p></li>
<li><p>Mengoptimalkan pengelolaan stok Gula berdasarkan prediksi harga
Model ini diharapkan dapat membantu Perusahaan dalam mengelola stok Gula perusahaan Perusahaan,sehingga saat prediksi Gula tinggi maka Perusahaan akan menjual stoknya dan ketika prediksi harga rendah maka Perusahaan menyimpan stoknya,hal tersebut dilakuakn untuk mengurangi resiko kerugian dan meningkatkan pendapatan.</p></li>
</ol>
</section>
<section id="rumusan-masalah">
<h2>3. RUMUSAN MASALAH<a class="headerlink" href="#rumusan-masalah" title="Link to this heading">#</a></h2>
<p>Berdasarkan latar belakang yang telah diuraikan, beberapa permasalahan yang dapat dirumuskan dalam proyek ini adalah sebagai berikut:</p>
<ol class="arabic simple">
<li><p>Bagaimana memprediksi harga Gula Pasir secara akurat?
harga Gula Pasir bersifat fluktatif sehingga susah untuk memprediksinya dengan akurat,rumusan masalah ini berfokus pada bagaimana membangun model prediksi harga Gula Pasir yang akurat.</p></li>
<li><p>Bagaimana prediksi harga Gula Pasir dapat membantu dalam meningkatkan pendapatan perusahaan?
Suatu Perusahaan Produsen Gula Pasir pasti memiliki Gudang yang menyimpan banyak stok,model prediksi dapat dugunakan utuk memprediksi harga kedepannya ketika harga pasar turun maka Perusahaan dapat menjual segera agar meminimalisir kerugian,ketika harga tinggi maka barang akan dijual dan akan mendapatkan pendapatan lebih.</p></li>
</ol>
</section>
<section id="data-yang-digunakan">
<h2>4. DATA YANG DIGUNAKAN<a class="headerlink" href="#data-yang-digunakan" title="Link to this heading">#</a></h2>
<p>Data yang digunakan dalam analisis ini adalah data harga beras yang diperoleh dari situs resmi Bank Indonesia dengan rentang waktu mulai dari tahun 2020 hingga 2024. Data tersebut mencakup 209 titik pengamatan, yang masing-masing diambil pada interval waktu mingguan. Informasi lebih lanjut dan akses langsung ke data harga pangan tersebut dapat ditemukan melalui situs resmi Bank Indonesia di <a class="reference external" href="https://www.bi.go.id/hargapangan">https://www.bi.go.id/hargapangan</a>.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="pembahasan">
<h1>PEMBAHASAN<a class="headerlink" href="#pembahasan" title="Link to this heading">#</a></h1>
<section id="data-understanding">
<h2>1. DATA UNDERSTANDING<a class="headerlink" href="#data-understanding" title="Link to this heading">#</a></h2>
<p>Data yang didapar merupakan data dengan index berupa tanggal dan juga fitur harga yang menjadi target untuk dilakuakn forecasting.
Data berupa angka numerik dan dalam rentang harga 13000-18000.
Data tidak memiliki missing value sehingga tidak perlu untuk dilakuakn inputasi missing value
Data hanya memiliki 1 fitur yang berupa target itu sendiri sehingga tidak ada hubungan dengan fitur lain
Untuk visualisasi data bisa dilihat pada gambar berikut</p>
<section id="visualisasi-data">
<h3>Visualisasi Data<a class="headerlink" href="#visualisasi-data" title="Link to this heading">#</a></h3>
<p>untuk memudahkan kita dalam memahami dataset ,ada baiknya kita ditampilkan dengan visual yang dapat dipahami oleh semua orang,pada visualisasi merupakan tahap awal kita dalam memahami dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># Baca file CSV</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Gula.csv&#39;</span><span class="p">)</span>
<span class="c1"># Membuat plot dengan matplotlib</span>
<span class="c1"># plt.figure(figsize=(16 ,8))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">128</span> <span class="p">,</span><span class="mi">64</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Gula Premium&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gula Premium&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Gula Lokal&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gula Lokal&#39;</span><span class="p">)</span>
<span class="c1"># Menambahkan judul dan label sumbu</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Harga Gula per Minggu di Pasar Jawa Timur&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tanggal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Harga (Rp)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Menampilkan plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">data</span><span class="o">=</span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># Baca file CSV</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Gula.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="c1"># Membuat plot dengan matplotlib</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="c1"># plt.figure(figsize=(16 ,8))</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">128</span> <span class="p">,</span><span class="mi">64</span><span class="p">))</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\parsers\readers.py:1026,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1015</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1022</span>     <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1023</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1024</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1026</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\parsers\readers.py:620,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">619</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">620</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">622</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\parsers\readers.py:1620,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1617</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1619</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1620</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\parsers\readers.py:1880,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1878</span>     <span class="k">if</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1879</span>         <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1880</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1881</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1882</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1883</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1884</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1885</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1886</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1887</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1888</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1889</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1890</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1891</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\common.py:873,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">868</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">872</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">873</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">874</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">875</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">876</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">877</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">878</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">879</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">880</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">881</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">882</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;Gula.csv&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="eksplorasi-data">
<h3>EKSPLORASI DATA<a class="headerlink" href="#eksplorasi-data" title="Link to this heading">#</a></h3>
<p>untuk memudahkan kita dalam memahami dataset ,ada baiknya kita ditampilkan dengan visual yang dapat dipahami oleh semua orang,pada visualisasi merupakan tahap awal kita dalam memahami dataset.</p>
</section>
<section id="struktur-dataset">
<h3>STRUKTUR DATASET<a class="headerlink" href="#struktur-dataset" title="Link to this heading">#</a></h3>
<p>Dataset ini merupakan dataset dengan tipe time series, sehingga tidak ada label seperti yang umumnya ditemukan pada dataset klasifikasi atau regresi. Dalam konteks time series, data diorganisasikan berdasarkan urutan waktu, dan setiap entri biasanya mewakili pengamatan pada titik waktu tertentu.
Karena tidak ada label,time series pada dataset ini hanya terdiri dari:</p>
<ul class="simple">
<li><p><strong>Waktu</strong> waktu tertentu dalam data</p></li>
<li><p><strong>minyak curah</strong> yang menunjukkan harga minyak curah pada waktu tertentu</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(209, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Date&#39;, &#39;Gula Premium&#39;, &#39;Gula Lokal&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Penjelasan lebih lengkapnya:</p>
<ul class="simple">
<li><p><strong>Date</strong> merupakan waktu pada data timeseries yang memiliki rentang 7 hari atau satu minggu antar data sehingga dapat dikatakan bahwa data time series ini merupakan data time series mingguan</p></li>
<li><p><strong>Gula Premium</strong> Merupakan Gula Premium pada waktu tertentu ,harga Gula Premium ini merupkan target yang akan kita prediksi nantinya.</p></li>
<li><p><strong>Gula Lokal</strong> Merupakan Gula Lokal pada waktu tertentu ,harga Gula Lokal ini merupkan target yang akan kita prediksi nantinya.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             Date Gula Premium Gula Lokal
count         209          209        209
unique        209           57         59
top     12/8/2020       14,300     11,950
freq            1           16         14
</pre></div>
</div>
</div>
</div>
</section>
<section id="identifikasi-kualitas-data">
<h3>IDENTIFIKASI KUALITAS DATA<a class="headerlink" href="#identifikasi-kualitas-data" title="Link to this heading">#</a></h3>
</section>
<section id="pendeteksian-missing-value">
<h3>PENDETEKSIAN MISSING VALUE<a class="headerlink" href="#pendeteksian-missing-value" title="Link to this heading">#</a></h3>
<p>Missing value merupakan data yang hilang pada suatu dataset. Hal ini bisa terjadi oleh beberapa faktor, diantaranya adalah :</p>
<ul class="simple">
<li><p>Interviewer recording error terjadi akibat kelalaian petugas pengumpul data (pewawancara), misalnya ada sejumlah pertanyaan yang terlewatkan</p></li>
<li><p>Respondent inability error terjadi akibat ketidakmampuan responden dalam memberikan jawaban akurat, misalnya karena tidak memahami pertanyaan, bosan atau kelelahan (respondent fatigue) akhirnya responden mengosongkan sejumlah pertanyaan atau berhenti mengisi kuesioner di tengah jalan.</p></li>
<li><p>Unwillingness respondent error terjadi karena responden tidak berkenan memberikan jawaban yang akurat, misalnya pertanyaan soal penghasilan, usia, berat badan, pengalaman melakukan pelanggaran hukum, dll.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>

<span class="c1"># Mendeteksi missing value</span>
<span class="n">missing_values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>

<span class="c1"># Menghitung jumlah missing value di setiap kolom</span>
<span class="n">missing_count</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Menampilkan hasil</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Missing value detection:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">missing_values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Jumlah missing value per kolom:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">missing_count</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Missing value detection:
       Date  Gula Premium  Gula Lokal
0    False         False       False
1    False         False       False
2    False         False       False
3    False         False       False
4    False         False       False
..     ...           ...         ...
204  False         False       False
205  False         False       False
206  False         False       False
207  False         False       False
208  False         False       False

[209 rows x 3 columns]

Jumlah missing value per kolom:
 Date            0
Gula Premium    0
Gula Lokal      0
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="pre-processing">
<h2>2. Pre Processing<a class="headerlink" href="#pre-processing" title="Link to this heading">#</a></h2>
<section id="sliding-windows">
<h3>Sliding Windows<a class="headerlink" href="#sliding-windows" title="Link to this heading">#</a></h3>
<p>sliding windows digunakan agar nantinya model dapat membaca history dari data sebelumnya ,atau untuk memory dari model tersebut</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fungsi untuk membuat data dalam bentuk X (input) dan y (output) dengan sliding window</span>
<span class="k">def</span> <span class="nf">create_dataset</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">time_steps</span><span class="p">):</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:(</span><span class="n">i</span> <span class="o">+</span> <span class="n">time_steps</span><span class="p">)])</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">time_steps</span><span class="p">])</span>  <span class="c1"># Output adalah data di langkah berikutnya</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="splitting-data-dan-normalisasi">
<h3>Splitting Data dan Normalisasi<a class="headerlink" href="#splitting-data-dan-normalisasi" title="Link to this heading">#</a></h3>
<p>langkah kita perlu untuk membagi data dan melakukan normalisasi kepada data,normalisasi bergunak agar menyamakan rentang value dari data agar tidak ada kesenjangan yang jauh,kemudian splitting digunakan untuk membagi data untuk training dan testing</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">LSTM</span><span class="p">,</span> <span class="n">Dense</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Load data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;Gula.csv&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>

<span class="c1"># Bersihkan kolom &#39;Gula Premium&#39; dan &#39;Gula Lokal&#39; dari tanda koma</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gula Premium&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gula Premium&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;,&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gula Lokal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gula Lokal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;,&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Menampilkan data setelah pembersihan</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Normalisasi Data (Min-Max Scaler)</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">scaled_data</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Menampilkan hasil normalisasi</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>  <span class="c1"># Melihat hasil normalisasi pertama</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            Gula Premium  Gula Lokal
Date                                
2020-12-08       13950.0     12050.0
2020-12-15       13850.0     12050.0
2020-12-22       13850.0     12050.0
2020-12-29       13950.0     12100.0
2021-01-05       13900.0     12100.0
[[0.10465116 0.06363636]
 [0.08139535 0.06363636]
 [0.08139535 0.06363636]
 [0.10465116 0.07272727]
 [0.09302326 0.07272727]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Membagi data menjadi input-output untuk model</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># Menampilkan bentuk data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of X:&quot;</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (samples, 3, 2) -&gt; 3 time steps, 2 fitur</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of y:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (samples, 2) -&gt; 2 fitur sebagai target</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of X: (206, 3, 2)
Shape of y: (206, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Membagi data menjadi 80% training dan 20% testing</span>
<span class="n">train_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="n">train_size</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">train_size</span><span class="p">:]</span>
<span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="n">train_size</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">train_size</span><span class="p">:]</span>

<span class="c1"># Menampilkan bentuk data training dan testing</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training data shape:&quot;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Testing data shape:&quot;</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training data shape: (164, 3, 2) (164, 2)
Testing data shape: (42, 3, 2) (42, 2)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="modelling">
<h2>3. Modelling<a class="headerlink" href="#modelling" title="Link to this heading">#</a></h2>
</section>
<section id="lstm">
<h2>LSTM<a class="headerlink" href="#lstm" title="Link to this heading">#</a></h2>
<p>model yang akan digunakan adalah lstm</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Membuat model LSTM</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>

<span class="c1"># Menambahkan lapisan LSTM</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>

<span class="c1"># Menambahkan lapisan Dense untuk output</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>  <span class="c1"># Karena kita punya 2 fitur sebagai output (Gula Premium dan Gula Lokal)</span>

<span class="c1"># Menyusun model</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>

<span class="c1"># Melatih model</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\men\AppData\Local\Programs\Python\Python312\Lib\site-packages\keras\src\layers\rnn\rnn.py:204: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential"</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
<span style="font-weight: bold"> Layer (type)                    </span><span style="font-weight: bold"> Output Shape           </span><span style="font-weight: bold">       Param # </span>

 lstm (<span style="color: #0087ff; text-decoration-color: #0087ff">LSTM</span>)                      (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">50</span>)                     <span style="color: #00af00; text-decoration-color: #00af00">10,600</span> 

 dense (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                    (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">2</span>)                         <span style="color: #00af00; text-decoration-color: #00af00">102</span> 

</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">10,702</span> (41.80 KB)
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">10,702</span> (41.80 KB)
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">0</span> (0.00 B)
</pre>
</div></div>
</div>
</section>
<section id="training-model">
<h2>training model<a class="headerlink" href="#training-model" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>



<span class="c1"># Menampilkan grafik loss selama pelatihan</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train Loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Test Loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">2s</span> 42ms/step - loss: 0.0768 - val_loss: 0.5864
Epoch 2/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0481 - val_loss: 0.4468
Epoch 3/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0411 - val_loss: 0.3235
Epoch 4/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0255 - val_loss: 0.2165
Epoch 5/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0179 - val_loss: 0.1252
Epoch 6/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0121 - val_loss: 0.0666
Epoch 7/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0098 - val_loss: 0.0440
Epoch 8/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0090 - val_loss: 0.0375
Epoch 9/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0078 - val_loss: 0.0331
Epoch 10/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0060 - val_loss: 0.0292
Epoch 11/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 0.0045 - val_loss: 0.0233
Epoch 12/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0040 - val_loss: 0.0145
Epoch 13/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 0.0032 - val_loss: 0.0102
Epoch 14/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 8ms/step - loss: 0.0019 - val_loss: 0.0094
Epoch 15/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0018 - val_loss: 0.0133
Epoch 16/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0016 - val_loss: 0.0175
Epoch 17/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0013 - val_loss: 0.0182
Epoch 18/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0012 - val_loss: 0.0166
Epoch 19/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0010 - val_loss: 0.0175
Epoch 20/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 8.8675e-04 - val_loss: 0.0196
Epoch 21/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0010 - val_loss: 0.0222
Epoch 22/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0010 - val_loss: 0.0198
Epoch 23/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 9.8149e-04 - val_loss: 0.0219
Epoch 24/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 8.9348e-04 - val_loss: 0.0216
Epoch 25/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 8.6688e-04 - val_loss: 0.0239
Epoch 26/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 7.7748e-04 - val_loss: 0.0255
Epoch 27/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 8.5347e-04 - val_loss: 0.0227
Epoch 28/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 9.8411e-04 - val_loss: 0.0208
Epoch 29/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 8.0161e-04 - val_loss: 0.0211
Epoch 30/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 9.5033e-04 - val_loss: 0.0213
Epoch 31/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 8.1797e-04 - val_loss: 0.0218
Epoch 32/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 8.1145e-04 - val_loss: 0.0219
Epoch 33/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 8.3153e-04 - val_loss: 0.0215
Epoch 34/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 8.9825e-04 - val_loss: 0.0212
Epoch 35/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 7.9477e-04 - val_loss: 0.0210
Epoch 36/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 9.3508e-04 - val_loss: 0.0207
Epoch 37/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 8.9564e-04 - val_loss: 0.0199
Epoch 38/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 8.1332e-04 - val_loss: 0.0188
Epoch 39/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 8.1000e-04 - val_loss: 0.0194
Epoch 40/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 7.2272e-04 - val_loss: 0.0161
Epoch 41/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 7.3550e-04 - val_loss: 0.0137
Epoch 42/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 8.2193e-04 - val_loss: 0.0152
Epoch 43/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 7.8091e-04 - val_loss: 0.0174
Epoch 44/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 7.8301e-04 - val_loss: 0.0135
Epoch 45/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 7.9243e-04 - val_loss: 0.0130
Epoch 46/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 6.5971e-04 - val_loss: 0.0142
Epoch 47/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 7.3507e-04 - val_loss: 0.0156
Epoch 48/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 7.7635e-04 - val_loss: 0.0159
Epoch 49/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 5.8850e-04 - val_loss: 0.0154
Epoch 50/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 7.1154e-04 - val_loss: 0.0150
Epoch 51/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 7.0648e-04 - val_loss: 0.0147
Epoch 52/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.8643e-04 - val_loss: 0.0144
Epoch 53/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.9616e-04 - val_loss: 0.0142
Epoch 54/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 7.0114e-04 - val_loss: 0.0127
Epoch 55/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 5.9434e-04 - val_loss: 0.0124
Epoch 56/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 6.4224e-04 - val_loss: 0.0134
Epoch 57/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.6876e-04 - val_loss: 0.0137
Epoch 58/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.8424e-04 - val_loss: 0.0129
Epoch 59/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 5.7049e-04 - val_loss: 0.0112
Epoch 60/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.9244e-04 - val_loss: 0.0118
Epoch 61/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.4554e-04 - val_loss: 0.0128
Epoch 62/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.2312e-04 - val_loss: 0.0119
Epoch 63/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.9669e-04 - val_loss: 0.0110
Epoch 64/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.0484e-04 - val_loss: 0.0114
Epoch 65/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 7.1231e-04 - val_loss: 0.0116
Epoch 66/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.7297e-04 - val_loss: 0.0109
Epoch 67/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.9064e-04 - val_loss: 0.0119
Epoch 68/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.1526e-04 - val_loss: 0.0112
Epoch 69/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 5.8545e-04 - val_loss: 0.0113
Epoch 70/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 5.6127e-04 - val_loss: 0.0111
Epoch 71/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 6.1004e-04 - val_loss: 0.0120
Epoch 72/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 5.6998e-04 - val_loss: 0.0127
Epoch 73/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.5381e-04 - val_loss: 0.0116
Epoch 74/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.7361e-04 - val_loss: 0.0109
Epoch 75/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 6.3902e-04 - val_loss: 0.0107
Epoch 76/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 5.8348e-04 - val_loss: 0.0107
Epoch 77/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 5.6184e-04 - val_loss: 0.0104
Epoch 78/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.3679e-04 - val_loss: 0.0095
Epoch 79/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 5.0946e-04 - val_loss: 0.0091
Epoch 80/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.6077e-04 - val_loss: 0.0096
Epoch 81/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 5.9803e-04 - val_loss: 0.0091
Epoch 82/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 5.7822e-04 - val_loss: 0.0084
Epoch 83/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 5.4196e-04 - val_loss: 0.0089
Epoch 84/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 5.8824e-04 - val_loss: 0.0096
Epoch 85/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 4.8180e-04 - val_loss: 0.0094
Epoch 86/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.3640e-04 - val_loss: 0.0088
Epoch 87/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 5.6017e-04 - val_loss: 0.0081
Epoch 88/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 5.4269e-04 - val_loss: 0.0078
Epoch 89/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 4.9078e-04 - val_loss: 0.0092
Epoch 90/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 5.5834e-04 - val_loss: 0.0085
Epoch 91/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 5.2152e-04 - val_loss: 0.0066
Epoch 92/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 5.9357e-04 - val_loss: 0.0072
Epoch 93/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 5.4702e-04 - val_loss: 0.0080
Epoch 94/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 5.9595e-04 - val_loss: 0.0077
Epoch 95/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 4.9419e-04 - val_loss: 0.0071
Epoch 96/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 4.7604e-04 - val_loss: 0.0079
Epoch 97/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 5.5315e-04 - val_loss: 0.0082
Epoch 98/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 5.8801e-04 - val_loss: 0.0077
Epoch 99/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 5.4495e-04 - val_loss: 0.0070
Epoch 100/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step - loss: 4.8850e-04 - val_loss: 0.0060
</pre></div>
</div>
<img alt="_images/d2270bafacfaaeb16e0f0825efe7326a7530281774b7a58399aec109bc032450.png" src="_images/d2270bafacfaaeb16e0f0825efe7326a7530281774b7a58399aec109bc032450.png" />
</div>
</div>
</section>
<section id="evaluasi">
<h2>4. Evaluasi<a class="headerlink" href="#evaluasi" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Menghitung MSE pada data test</span>
<span class="n">test_loss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test Loss (MSE): </span><span class="si">{</span><span class="n">test_loss</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Prediksi untuk test set</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Denormalisasi hasil prediksi dan data aktual</span>
<span class="n">y_pred_denorm</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<span class="n">y_test_denorm</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>

<span class="c1"># Menampilkan beberapa hasil prediksi</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediksi: </span><span class="si">{</span><span class="n">y_pred_denorm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">, Aktual: </span><span class="si">{</span><span class="n">y_test_denorm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0058
Test Loss (MSE): 0.006024118512868881
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 101ms/step
Prediksi: [16693.387 16451.773], Aktual: [16700. 16250.]
Prediksi: [16696.658 16437.596], Aktual: [16650. 16300.]
Prediksi: [16704.79  16446.242], Aktual: [16850. 16450.]
Prediksi: [16756.475 16497.168], Aktual: [16950. 16550.]
Prediksi: [16834.098 16591.154], Aktual: [17000. 16600.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">joblib</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;lstm_model_Gula.h5&#39;</span><span class="p">)</span>

<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="s1">&#39;scaler_gula.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save(&#39;my_model.keras&#39;)` or `keras.saving.save_model(model, &#39;my_model.keras&#39;)`. 
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;scaler_gula.pkl&#39;]
</pre></div>
</div>
</div>
</div>
<section id="test">
<h3>test<a class="headerlink" href="#test" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
<span class="kn">import</span> <span class="nn">joblib</span>

<span class="c1"># Load model dan scaler</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;lstm_model_Gula.h5&#39;</span><span class="p">)</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;scaler_gula.pkl&#39;</span><span class="p">)</span>

<span class="c1"># Data terakhir yang akan diprediksi (pastikan data ini dalam format yang benar)</span>
<span class="n">last_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="p">[</span><span class="mi">15000</span><span class="p">,</span> <span class="mi">14500</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">15500</span><span class="p">,</span> <span class="mi">15000</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">14500</span><span class="p">,</span> <span class="mi">14000</span><span class="p">]])</span>  <span class="c1"># Ambil 3 waktu langkah terakhir sebagai input</span>

<span class="c1"># Lakukan scaling pada input terakhir dengan scaler</span>
<span class="n">last_input_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">last_input</span><span class="p">)</span>

<span class="c1"># List untuk menyimpan hasil prediksi</span>
<span class="n">predictions_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Prediksi untuk 2 minggu ke depan</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>  <span class="c1"># Prediksi 5 periode (misalnya minggu ke-1, ke-2, dst)</span>
    <span class="c1"># Melakukan prediksi dengan input yang sudah discale</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">last_input_scaled</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># Mengubah bentuk input sesuai yang dibutuhkan LSTM</span>
    <span class="n">prediction_denorm</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>  <span class="c1"># Denormalisasi hasil prediksi</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediksi minggu ke-</span><span class="si">{</span><span class="n">_</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">prediction_denorm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Menyimpan hasil prediksi dalam list</span>
    <span class="n">predictions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction_denorm</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>  <span class="c1"># Gunakan flatten agar prediksi berbentuk array 1D</span>

    <span class="c1"># Update input dengan prediksi terbaru dan lakukan scaling pada prediksi baru</span>
    <span class="n">last_input_scaled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">last_input_scaled</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Konversi list hasil prediksi ke dalam array numpy (optional)</span>
<span class="n">predictions_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions_list</span><span class="p">)</span>

<span class="c1"># Print hasil dalam array numpy</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hasil prediksi dalam bentuk array numpy:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">predictions_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:absl:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
c:\Users\men\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 112ms/step
Prediksi minggu ke-1: [[15239.761 14624.775]]
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 17ms/step
Prediksi minggu ke-2: [[15275.906 14647.395]]
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 23ms/step
Prediksi minggu ke-3: [[15174.636 14410.47 ]]
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 17ms/step
Prediksi minggu ke-4: [[15346.542 14689.093]]
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 16ms/step
Prediksi minggu ke-5: [[15363.303  14680.6045]]
Hasil prediksi dalam bentuk array numpy:
[[15239.761  14624.775 ]
 [15275.906  14647.395 ]
 [15174.636  14410.47  ]
 [15346.542  14689.093 ]
 [15363.303  14680.6045]]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="deployment">
<h2>Deployment<a class="headerlink" href="#deployment" title="Link to this heading">#</a></h2>
<p>link deployment :</p>
<p><a class="reference external" href="https://huggingface.co/spaces/RekaF/PSD-UAS">https://huggingface.co/spaces/RekaF/PSD-UAS</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="minyak_curah.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">PREDIKSI HARGA MINYAK CURAH UNTUK MENGURANGI RESIKO KERUGIAN PERUSAHAAN MINYAK CURAH</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">PREDIKSI HARGA GULA PASIR UNTUK MENGURANGI RESIKO KERUGIAN PERUSAHAAN GULA PASIR</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pendahuluan">PENDAHULUAN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#latar-belakang">1. LATAR BELAKANG</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan-proyek">2. TUJUAN PROYEK</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rumusan-masalah">3. RUMUSAN MASALAH</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-yang-digunakan">4. DATA YANG DIGUNAKAN</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pembahasan">PEMBAHASAN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">1. DATA UNDERSTANDING</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-data">Visualisasi Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eksplorasi-data">EKSPLORASI DATA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#struktur-dataset">STRUKTUR DATASET</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#identifikasi-kualitas-data">IDENTIFIKASI KUALITAS DATA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pendeteksian-missing-value">PENDETEKSIAN MISSING VALUE</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing">2. Pre Processing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sliding-windows">Sliding Windows</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#splitting-data-dan-normalisasi">Splitting Data dan Normalisasi</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling">3. Modelling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lstm">LSTM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-model">training model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi">4. Evaluasi</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test">test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deployment">Deployment</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>